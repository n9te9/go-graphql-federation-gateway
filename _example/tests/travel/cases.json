[
  {
    "name": "Basic Flight (Single Service)",
    "query": "query GetFlight($number: String!, $date: String!) { flight(number: $number, departureDate: $date) { number departureDate origin destination } }",
    "variables": { "number": "AA100", "date": "2026-03-01" },
    "expected": {
      "flight": {
        "number": "AA100",
        "departureDate": "2026-03-01",
        "origin": "SFO",
        "destination": "JFK"
      }
    }
  },
  {
    "name": "Flight with Bookings (Federation Extension)",
    "query": "query FlightWithBookings($number: String!, $date: String!) { flight(number: $number, departureDate: $date) { number origin destination bookings { id } } }",
    "variables": { "number": "AA100", "date": "2026-03-01" },
    "expected": {
      "flight": {
        "number": "AA100",
        "origin": "SFO",
        "destination": "JFK",
        "bookings": [
          {
            "id": "booking1"
          }
        ]
      }
    }
  },
  {
    "name": "Booking with Flight Reference",
    "query": "query FlightBookings($number: String!, $date: String!) { flight(number: $number, departureDate: $date) { bookings { id flight { number origin destination } } } }",
    "variables": { "number": "AA100", "date": "2026-03-01" },
    "expected": {
      "flight": {
        "bookings": [
          {
            "id": "booking1",
            "flight": {
              "number": "AA100",
              "origin": "SFO",
              "destination": "JFK"
            }
          }
        ]
      }
    }
  },
  {
    "name": "Typename Check (Composite Key)",
    "query": "query TypenameCheck($number: String!, $date: String!) { flight(number: $number, departureDate: $date) { __typename number departureDate bookings { __typename id flight { __typename number } } } }",
    "variables": { "number": "AA100", "date": "2026-03-01" },
    "expected": {
      "flight": {
        "__typename": "Flight",
        "number": "AA100",
        "departureDate": "2026-03-01",
        "bookings": [
          {
            "__typename": "Booking",
            "id": "booking1",
            "flight": {
              "__typename": "Flight",
              "number": "AA100"
            }
          }
        ]
      }
    }
  },
  {
    "name": "Federation Feature: Fragment Spread",
    "description": "Verify fragment spread support with named fragments",
    "query": "query { flight(number: \"AA100\", departureDate: \"2026-03-01\") { ...FlightFields } } fragment FlightFields on Flight { number origin destination }",
    "variables": {},
    "expected": {
      "flight": {
        "number": "AA100",
        "origin": "SFO",
        "destination": "JFK"
      }
    }
  },
  {
    "name": "Federation Feature: Inline Fragments",
    "description": "Verify inline fragment support",
    "query": "query { flight(number: \"AA100\", departureDate: \"2026-03-01\") { number ... on Flight { origin destination } } }",
    "variables": {},
    "expected": {
      "flight": {
        "number": "AA100",
        "origin": "SFO",
        "destination": "JFK"
      }
    }
  },
  {
    "name": "Federation Feature: Nested Fragments",
    "description": "Verify nested fragment expansion (fragments referencing other fragments)",
    "query": "query { flight(number: \"AA100\", departureDate: \"2026-03-01\") { ...FlightWithRoute } } fragment FlightWithRoute on Flight { ...FlightNumber ...RouteInfo } fragment FlightNumber on Flight { number } fragment RouteInfo on Flight { origin destination }",
    "variables": {},
    "expected": {
      "flight": {
        "number": "AA100",
        "origin": "SFO",
        "destination": "JFK"
      }
    }
  },
  {
    "name": "Federation v2: @requires - Total Cost Computation",
    "description": "Verify that @requires automatically fetches price field for totalCost calculation",
    "query": "query { flight(number: \"AA100\", departureDate: \"2026-03-01\") { number totalCost } }",
    "variables": {},
    "expected": {
      "flight": {
        "number": "AA100",
        "totalCost": 550
      }
    }
  },
  {
    "name": "Federation v2: @inaccessible - Should block access to aircraft type",
    "description": "Verify that @inaccessible field cannot be queried",
    "query": "query { flight(number: \"AA100\", departureDate: \"2026-03-01\") { number aircraftType } }",
    "variables": {},
    "expectedError": true,
    "expectedErrorMessage": "Cannot query field \"aircraftType\" on type \"Flight\""
  },
  {
    "name": "Federation v2: @tag - Fields with tags should work normally",
    "description": "Verify that @tag fields can be queried (tags are metadata)",
    "query": "query { flight(number: \"AA100\", departureDate: \"2026-03-01\") { number origin destination } }",
    "variables": {},
    "expected": {
      "flight": {
        "number": "AA100",
        "origin": "SFO",
        "destination": "JFK"
      }
    }
  },
  {
    "name": "Variables: Multiple String Variables for Composite Key",
    "description": "Verify multiple string variables work for composite key queries",
    "query": "query FlightVars($flightNum: String!, $date: String!) { flight(number: $flightNum, departureDate: $date) { number departureDate origin destination price } }",
    "variables": { "flightNum": "AA100", "date": "2026-03-01" },
    "expected": {
      "flight": {
        "number": "AA100",
        "departureDate": "2026-03-01",
        "origin": "SFO",
        "destination": "JFK",
        "price": 500
      }
    }
  },
  {
    "name": "Variables: Optional Variable Override",
    "description": "Verify variables work correctly with different values",
    "query": "query FlightDefaults($num: String!, $date: String!) { flight(number: $num, departureDate: $date) { number origin destination } }",
    "variables": { "num": "UA200", "date": "2026-04-01" },
    "expected": {
      "flight": {
        "number": "UA200",
        "origin": "HND",
        "destination": "NRT"
      }
    }
  },
  {
    "name": "Variables: Nested Query with Composite Key Variables",
    "description": "Verify variables work in nested queries with composite keys",
    "query": "query FlightBookingsVar($fNum: String!, $fDate: String!) { flight(number: $fNum, departureDate: $fDate) { number bookings { id flight { number origin destination } } } }",
    "variables": { "fNum": "AA100", "fDate": "2026-03-01" },
    "expected": {
      "flight": {
        "number": "AA100",
        "bookings": [
          {
            "id": "booking1",
            "flight": {
              "number": "AA100",
              "origin": "SFO",
              "destination": "JFK"
            }
          }
        ]
      }
    }
  }
]
