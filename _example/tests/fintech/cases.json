[
  {
    "name": "Get Customer and Accounts",
    "query": "query { customer(id: \"1\") { name accounts { iban balance } } }",
    "variables": {},
    "expected": {
      "customer": {
        "name": "Customer 1",
        "accounts": [
          {
            "iban": "IBAN 1",
            "balance": 1000
          }
        ]
      }
    }
  },
  {
    "name": "Get Account and Transactions",
    "query": "query { account(iban: \"IBAN 1\") { iban transactions { amount } } }",
    "variables": {},
    "expected": {
      "account": {
        "iban": "IBAN 1",
        "transactions": [
          {
            "amount": 100
          }
        ]
      }
    }
  },
  {
    "name": "Federation Feature: Fragment Spread",
    "description": "Verify fragment spread support with named fragments",
    "query": "query { customer(id: \"1\") { ...CustomerFields } } fragment CustomerFields on Customer { name accounts { iban balance } }",
    "variables": {},
    "expected": {
      "customer": {
        "name": "Customer 1",
        "accounts": [
          {
            "iban": "IBAN 1",
            "balance": 1000
          }
        ]
      }
    }
  },
  {
    "name": "Federation Feature: Inline Fragments",
    "description": "Verify inline fragment support",
    "query": "query { customer(id: \"1\") { name ... on Customer { accounts { iban balance } } } }",
    "variables": {},
    "expected": {
      "customer": {
        "name": "Customer 1",
        "accounts": [
          {
            "iban": "IBAN 1",
            "balance": 1000
          }
        ]
      }
    }
  },
  {
    "name": "Federation Feature: Nested Fragments",
    "description": "Verify nested fragment expansion (fragments referencing other fragments)",
    "query": "query { customer(id: \"1\") { ...CustomerWithAccounts } } fragment CustomerWithAccounts on Customer { ...BasicCustomer accounts { ...AccountInfo } } fragment BasicCustomer on Customer { name } fragment AccountInfo on Account { iban balance }",
    "variables": {},
    "expected": {
      "customer": {
        "name": "Customer 1",
        "accounts": [
          {
            "iban": "IBAN 1",
            "balance": 1000
          }
        ]
      }
    }
  },
  {
    "name": "Federation v2: @requires - Risk Score Computation",
    "description": "Verify that @requires automatically fetches balance field for riskScore calculation",
    "query": "query { account(iban: \"IBAN 1\") { iban riskScore } }",
    "variables": {},
    "expected": {
      "account": {
        "iban": "IBAN 1",
        "riskScore": 10
      }
    }
  },
  {
    "name": "Federation v2: @inaccessible - Should block access to SSN",
    "description": "Verify that @inaccessible field cannot be queried",
    "query": "query { customer(id: \"1\") { id name ssn } }",
    "variables": {},
    "expectedError": true,
    "expectedErrorMessage": "Cannot query field \"ssn\" on type \"Customer\""
  },
  {
    "name": "Federation v2: @tag - Fields with tags should work normally",
    "description": "Verify that @tag fields can be queried (tags are metadata)",
    "query": "query { customer(id: \"1\") { id name tier } }",
    "variables": {},
    "expected": {
      "customer": {
        "id": "1",
        "name": "Customer 1",
        "tier": "Premium"
      }
    }
  }
]
