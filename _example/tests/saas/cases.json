[
  {
    "name": "Basic Organization (Single Service)",
    "query": "query GetOrganization($id: ID!) { organization(id: $id) { id name } }",
    "variables": { "id": "org1" },
    "expected": {
      "organization": {
        "id": "org1",
        "name": "Acme Corp"
      }
    }
  },
  {
    "name": "Organization with Billing (Federation Extension)",
    "query": "query OrgWithBilling($id: ID!) { organization(id: $id) { id name billing { id plan } } }",
    "variables": { "id": "org1" },
    "expected": {
      "organization": {
        "id": "org1",
        "name": "Acme Corp",
        "billing": {
          "id": "bill1",
          "plan": "Enterprise"
        }
      }
    }
  },
  {
    "name": "Project with Organization Reference",
    "query": "query GetProject($id: ID!) { project(id: $id) { id name organization { id name } } }",
    "variables": { "id": "proj1" },
    "expected": {
      "project": {
        "id": "proj1",
        "name": "Project Alpha",
        "organization": {
          "id": "org1",
          "name": "Acme Corp"
        }
      }
    }
  },
  {
    "name": "Project with Organization and Billing (Multi-Service)",
    "query": "query ProjectWithOrgBilling($id: ID!) { project(id: $id) { id name organization { id name billing { plan } } } }",
    "variables": { "id": "proj1" },
    "expected": {
      "project": {
        "id": "proj1",
        "name": "Project Alpha",
        "organization": {
          "id": "org1",
          "name": "Acme Corp",
          "billing": {
            "plan": "Enterprise"
          }
        }
      }
    }
  },
  {
    "name": "Typename Check (Cross-Service Metadata)",
    "query": "query TypenameCheck($id: ID!) { organization(id: $id) { __typename id name billing { __typename id plan } } }",
    "variables": { "id": "org1" },
    "expected": {
      "organization": {
        "__typename": "Organization",
        "id": "org1",
        "name": "Acme Corp",
        "billing": {
          "__typename": "BillingInfo",
          "id": "bill1",
          "plan": "Enterprise"
        }
      }
    }
  },
  {
    "name": "Federation v2: @shareable Type Access",
    "description": "Verify Organization @shareable type can be queried from different entry points",
    "query": "query { org1: organization(id: \"org1\") { id name } proj: project(id: \"proj1\") { id name organization { id } } }",
    "variables": {},
    "expected": {
      "org1": {
        "id": "org1",
        "name": "Acme Corp"
      },
      "proj": {
        "id": "proj1",
        "name": "Project Alpha",
        "organization": {
          "id": "org1"
        }
      }
    }
  },
  {
    "name": "Federation Feature: Fragment Spread",
    "description": "Verify fragment spread support with named fragments",
    "query": "query { organization(id: \"org1\") { ...OrgFields } } fragment OrgFields on Organization { id name billing { plan } }",
    "variables": {},
    "expected": {
      "organization": {
        "id": "org1",
        "name": "Acme Corp",
        "billing": {
          "plan": "Enterprise"
        }
      }
    }
  },
  {
    "name": "Federation Feature: Inline Fragments",
    "description": "Verify inline fragment support",
    "query": "query { organization(id: \"org1\") { id ... on Organization { name billing { plan } } } }",
    "variables": {},
    "expected": {
      "organization": {
        "id": "org1",
        "name": "Acme Corp",
        "billing": {
          "plan": "Enterprise"
        }
      }
    }
  },
  {
    "name": "Federation Feature: Nested Fragments",
    "description": "Verify nested fragment expansion (fragments referencing other fragments)",
    "query": "query { organization(id: \"org1\") { ...OrgWithBilling } } fragment OrgWithBilling on Organization { ...BasicOrg billing { ...BillingInfo } } fragment BasicOrg on Organization { id name } fragment BillingInfo on BillingInfo { plan }",
    "variables": {},
    "expected": {
      "organization": {
        "id": "org1",
        "name": "Acme Corp",
        "billing": {
          "plan": "Enterprise"
        }
      }
    }
  },
  {
    "name": "Federation v2: @requires - Monthly Cost Computation",
    "description": "Verify that @requires automatically fetches employeeCount field for monthlyCost calculation",
    "query": "query { organization(id: \"org1\") { id name monthlyCost } }",
    "variables": {},
    "expected": {
      "organization": {
        "id": "org1",
        "name": "Acme Corp",
        "monthlyCost": 5000
      }
    }
  },
  {
    "name": "Federation v2: @inaccessible - Should block access to Tax ID",
    "description": "Verify that @inaccessible field cannot be queried",
    "query": "query { organization(id: \"org1\") { id name taxId } }",
    "variables": {},
    "expectedError": true,
    "expectedErrorMessage": "Cannot query field \"taxId\" on type \"Organization\""
  },
  {
    "name": "Federation v2: @tag - Fields with tags should work normally",
    "description": "Verify that @tag fields can be queried (tags are metadata)",
    "query": "query { organization(id: \"org1\") { id name employeeCount } }",
    "variables": {},
    "expected": {
      "organization": {
        "id": "org1",
        "name": "Acme Corp",
        "employeeCount": 50
      }
    }
  }
]
